경진대회 대본

안녕하세요 개발톤 고학년부 클라우드스페이스, AI전공 천유민, 구민지, 호연수 그리고 발표를 맡은 김진아 입니다. 
작품 개요, 개발 과정, 추후 응용 방향 순으로 발표를 진행하겠습니다. 

Crowd Space 제작 동기는 기존의 인구 밀도 확인 서비스의 실시간 정보 제공 미비의 한계점을 극복하는 것 입니다. 실시간 변동 정보 부족으로 특정 지역에 인파가 밀집되어 위험상황이 발생할 수 있습니다.

저희 서비스는 CCTV 영상 분석을 통해, 실시간 인구 밀도 및 폭력행위를 감지하고, 이를 시각적으로 나타내어 사용자들의 안전 및 편의성을 증진시킵니다. 기존에 수집된 데이터를 기반으로 현재 해당 지역의 실시간 복잡도를 3단계, 여유, 보통, 혼잡 단계로 표시합니다. 또한, 수집된 데이터를 바탕으로 과거, 미래의 복잡도를 예측하여 시간별 복잡 예상 정도를 표시합니다.
뿐만 아니라, 현재 실시간 밀집도를 기준으로 폭력 행위를 감지하여 보다 효율적이고 빠른 대처가 가능하게 합니다.

YOLO는 실시간 딥러닝 기반의 객체 탐지 알고리즘이며, 이 중 신속한 정보 제공을 위해, real time detection에 가장 적합하다 평가받고 있는 Yolov8 nano 모델을 사용하였습니다.

보안상의 이유로 직접적인 CCTV 작동 데이터를 확보할 수 없었습니다. 따라서 데이터 수집을 위해  세 지역의 유튜브의 라이브 스트리밍 영상을 활용하여 데이터를 수집하였습니다.
영상에서 사람과 교통 수단 등을 검출하여, 해당 객체의 class 넘버와 위치, 시간 등을 수집하였습니다. 이를 통해 동일한 시간대에 서로 다른 거리에서의 인구 밀도와, 도로의 전반적 정보를 비교하고 분석하였습니다. 

위험 상황 감지를 위한 작업으로 YOLO 모델을 활용하였으며, 이를 위해 violence 데이터셋을 활용한 전이 학습을 수행했습니다. 효율적인 감지를 위해 최근 30분 간의 프레임에서 탐지된 사람의 평균 수를 계산하여 값이 5명 미만일 때에만 violence 감지 모델을 실행하도록 조건을 설정하였습니다.

사용한 violence 데이터셋은 두 개의 클래스로 분류되며, 정상 데이터와 위험 데이터로 구성되어 있습니다. 위험 데이터에는 싸움, 위협 등 다양한 폭력적인 상황이 포함되어 있습니다. 이 데이터셋을 바탕으로 YOLO 모델을 전이 학습시켰으며, 300 epoch 동안 학습을 진행하였습니다. 학습 결과로 얻은 F1 스코어가 0.9469이며, mAP50-95가 0.7인 성능을 확인할 수 있었습니다. 이로 볼 때, 모델이 물체 검출 작업에서 어느 정도 높은 성능을 보임을 알 수 있었습니다.

이동 경로 분석을 위해 추적에 걸리는 시간이 짧고 실시간 비디오 스트림과 같은 환경에서도 적용 가능한 특징을 가진 DeepSORT를 활용하였습니다. 수집한 데이터 중에서는 영상에서 탐지된 사람 객체에 대한 정보를 추출하였습니다. 이 정보는 프레임별 위치, 시간 등을 포함하며, 이를 통해 사람들의 이동 경로와 행동을 분석하고 유동인구 변화를 파악하는 데 활용되었습니다. 

Kaggle의 GPU T4x2를 활용하여 1일부터 15일 동안 하루 4시간씩 데이터를 수집하였습니다. 다음 표는 저희가 데이터를 수집한 일별 시간을 나타냅니다. 데이터의 다양성을 고려하기 위해 시간대 및 주중/주말/공휴일에 따른 데이터 수집 시간을 조정하였습니다. 수집된 데이터 양이 제한적이었기 때문에, 모델의 성능 향상을 위해 data augmentation 작업을 수행하였습니다.

CTGAN은 Conditional Tabular GAN의 약어로, Conditional GAN을 기반으로 한 GAN 아키텍처입니다. 
저희 서비스는 실시간 밀집도 분석 및 예측, 그리고 유동인구 분석을 실행합니다. 이로 인해 시간-연속적 데이터와 사람/교통수단의 수-이산적 데이터 모두가 포함된 데이터를 다루게 됩니다. 이를 같이 학습시킬 경우, 이산적인 데이터는 각 카테고리별로 빈도수가 다르며, 연속형 데이터는 multi-modal distribution을 가질 수 있는 문제점이 발생할 수 있습니다.
이러한 문제점을 극복하기 위해 CTGAN은 mode specific normalization과 Training by Sampling 작업을 수행하여 해당 문제를 해결합니다. 데이터와 모델이 비교적 간단하여 5000 epoch으로 설정하여 보다 정확한 데이터를 생성하고자 했으며, 생성된 데이터의 Overall Quality Score가 0.9 이상으로, 원 데이터와 유사한 형태의 가짜 데이터가 생성되었음을 알 수 있었습니다. 이 때, 없는 시간대의 데이터를 생성하기 위해 조건부 샘플링에서 day와 time을 다양한 값으로 설정하여 진행했으며, 데이터 양이 적은 경우에는 day_Type-주중/주말/공휴일 조건을 활용하여 생성하였습니다. 

가공한 데이터를 밀집도, 도로 정보 및 유동인구 분석에 대하여 학습해 예측하는데 사용하였습니다.
저희는 요일, 시간대별로 해당 골목을 얼마나 이동하는지에 대한 시계열 데이터를 수집했기 때문에 데이터가 가지고 있는 시간적 특성을, 예측에도 고려해주기 위해 시계열 데이터 학습에 특화된 lstm을 사용했습니다. 

먼저 수행한 것은,  'X일 X시간대의 혼잡도 예측'과, 'X일 X시간대의 도로 정보'입니다. 이를 위해 모델의 입력으로는 요일(day), 시간(time), 그리고 요일의 유형(day_type)을 사용하였고, 출력으로는 해당 시간대에 해당 도로에서 발생하는 사람, 차량, 자전거의 수를 명 또는 개수로 예측하였습니다. 학습 과정에서는 하이퍼 파라미터 튜닝을 수행하여 모델을 최적화하였고, 이로써 얻어낸 RMSE값은 약 4 전후로 나왔습니다. 이의 모델로, n시간의 혼잡도와, n시간의 사람, 교통수단의 비율을 예측하여 사용자에게 제공합니다.

다음 수행한 것은 tracking으로 수집한 데이터를 이용해  'X일 X시간대에 어느 방향으로 많이 이동하는지에 대한 사람 수 예측'입니다. 학습의 input은 day, time, day_type 이고, output은 해당 요일 시간대에 사람 수에 대한 예측입니다. RMSE 값은 약 3 전후로 나왔습니다. 이의 모델로, n방향으로가는 사람 수를 예측하여, 유동인구 분석과, CCTV가 없는 이어진 구역의 인구수를 파악하여 사용자에게 제공합니다. 

저희가 만든 모델을 가시적으로 보여드리기 위해 만든 어플리케이션 화면입니다. 
지도 기반 인터페이스를 구축하여 그 위에 인구 밀도에 따른 혼잡도 3단계를 아이콘으로 표시하였습니다. 
만약 violence detection이 실행되었는데 이상행동이 감지되었을 경우 CCTV 아이콘 대신 주의 표시가 뜨는 것을 볼 수 있습니다. 
아이콘을 터치하면 해당 거리명과 함께 거리의 현재 혼잡도, 시간별 인구 혼잡도, 사람&자동차&이륜 자동차의 시간별 거리 이용 비율을 확인할 수 있습니다. 
메인 화면 우측의 화면은 cctv가 없는 거리의 시간별 예상 혼잡도입니다. 
cctv가 없는 구역은 tracking 데이터를 바탕으로, 해당 거리와 이어지는 거리의 예상 혼잡도를 나타냅니다.

앞에서 소개해 드린 기능 뿐만 아니라 추후에 여러 기능들을 추가해 궁극적으로 도시 안전을 지키고, 대비할 수 있는 모델을 만들기 위해 노력하겠습니다. 
감사합니다.  